{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\GiftCode/assets\\Script\\Model\\Dialog\\GiftCode\\GiftCode.js"],"names":["BrowserUtil","require","cc","Class","extends","Component","properties","giftcode","default","type","EditBox","captcha","capchaSprite","Sprite","onLoad","self","editboxs","keyHandle","t","keyCode","macro","KEY","tab","changeNextFocusEditBox","preventDefault","enter","focusGame","onSendClick","escape","RedT","inGame","dialog","onClickBack","onEnable","sys","isBrowser","addEvent","node","runAction","actionShow","reCaptcha","onDisable","removeEvent","clean","resetSizeDialog","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","getHTMLElementByEditBox","addEventListener","removeEventListener","off","event","isTop","e","i","length","checkEditBoxFocus","focusEditBox","notice","active","loading","string","error","show","title","text","send","code","initCaptcha","o","Image","src","width","height","setTimeout","Texture2D","initWithElement","handleLoadedTexture","SpriteFrame","spriteFrame"],"mappings":"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","file":"GiftCode.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\GiftCode","sourcesContent":["\r\nvar BrowserUtil = require('BrowserUtil');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        giftcode: {\r\n            default: null,\r\n            type: cc.EditBox,\r\n        },\r\n        captcha: {\r\n            default: null,\r\n            type: cc.EditBox,\r\n        },\r\n        capchaSprite: cc.Sprite,\r\n    },\r\n    onLoad () {\r\n        var self = this;\r\n        this.editboxs = [this.giftcode, this.captcha];\r\n        this.keyHandle = function(t) {\r\n            return t.keyCode === cc.macro.KEY.tab ? (self.changeNextFocusEditBox(),\r\n                t.preventDefault && t.preventDefault(),\r\n                !1) : t.keyCode === cc.macro.KEY.enter ? (BrowserUtil.focusGame(), self.onSendClick(),\r\n                t.preventDefault && t.preventDefault(),\r\n                !1) : t.keyCode === cc.macro.KEY.escape ? (cc.RedT.inGame.dialog.onClickBack(),\r\n                t.preventDefault && t.preventDefault(),\r\n                !1) : void 0\r\n        }\r\n    },\r\n    onEnable: function () {\r\n        cc.sys.isBrowser && this.addEvent();\r\n        this.node.runAction(cc.RedT.inGame.dialog.actionShow);\r\n        this.reCaptcha();\r\n    },\r\n    onDisable: function () {\r\n        cc.sys.isBrowser && this.removeEvent();\r\n        this.clean();\r\n        cc.RedT.inGame.dialog.resetSizeDialog(this.node);\r\n    },\r\n    addEvent: function() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        for (var t in this.editboxs) {\r\n            BrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).addEventListener(\"keydown\", this.keyHandle, !1)\r\n        }\r\n    },\r\n    removeEvent: function() {\r\n        for (var t in this.editboxs) {\r\n            BrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).removeEventListener(\"keydown\", this.keyHandle, !1)\r\n        }\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n    },\r\n    onKeyDown: function (event) {\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.escape:\r\n                this.isTop() && cc.RedT.inGame.dialog.onClickBack();\r\n                break;\r\n            case cc.macro.KEY.tab:\r\n                this.isTop() && this.changeNextFocusEditBox();\r\n                break;\r\n            case cc.macro.KEY.enter:\r\n                this.isTop() && this.onSendClick();\r\n        }\r\n    },\r\n    changeNextFocusEditBox: function() {\r\n        for (var t = !1, e = 0, i = this.editboxs.length; e < i; e++){\r\n            if (BrowserUtil.checkEditBoxFocus(this.editboxs[e])) {\r\n                BrowserUtil.focusEditBox(this.editboxs[e]);\r\n                t = !0;\r\n                break\r\n            }\r\n        }\r\n        !t && 0 < this.editboxs.length && BrowserUtil.focusEditBox(this.editboxs[0]);\r\n    },\r\n    isTop: function() {\r\n        return !cc.RedT.inGame.notice.node.active && !cc.RedT.inGame.loading.active;\r\n    },\r\n    clean: function(){\r\n        this.giftcode.string = this.captcha.string = '';\r\n    },\r\n    onSendClick: function() {\r\n        var error = null;\r\n\r\n        if (this.giftcode.string.length > 32 || this.giftcode.string.length < 3)\r\n            error = 'Mã Giftcode không hợp lệ...';\r\n        else if (this.captcha.string.length < 4)\r\n          error = 'Vui lòng nhập Captcha.';\r\n\r\n        if (error) {\r\n            cc.RedT.inGame.notice.show({title:\"GIFT CODE\", text:error});\r\n            return;\r\n        }else{\r\n            cc.RedT.send({giftcode: {code: this.giftcode.string, captcha:this.captcha.string}});\r\n        }\r\n    },\r\n    initCaptcha: function(t) {\r\n        var i = this\r\n          , o = new Image;\r\n        o.src = t,\r\n        o.width = 150,\r\n        o.height = 50,\r\n        setTimeout(function() {\r\n            var t = new cc.Texture2D;\r\n            t.initWithElement(o),\r\n            t.handleLoadedTexture();\r\n            var e = new cc.SpriteFrame(t);\r\n            i.capchaSprite.spriteFrame = e\r\n        }, 10)\r\n    },\r\n    reCaptcha: function(){\r\n        cc.RedT.send({captcha: 'giftcode'});\r\n    },\r\n});\r\n"]}