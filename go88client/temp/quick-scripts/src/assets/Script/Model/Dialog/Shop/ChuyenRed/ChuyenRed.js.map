{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\Shop\\ChuyenRed/assets\\Script\\Model\\Dialog\\Shop\\ChuyenRed\\ChuyenRed.js"],"names":["BrowserUtil","require","helper","cc","Class","extends","Component","properties","nickname","EditBox","red","messenger","otp","redPhi","Label","rednhan","shop","Node","isdaily","meDaily","init","obj","RedT","self","editboxs","keyHandle","t","keyCode","macro","KEY","tab","isTop","changeNextFocusEditBox","preventDefault","enter","focusGame","onChuyenClick","onEnable","reCheckMeDL","sys","isBrowser","addEvent","DaiLy","loadDaiLy","onDisable","removeEvent","clean","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","getHTMLElementByEditBox","addEventListener","removeEventListener","off","event","e","i","length","checkEditBoxFocus","focusEditBox","inGame","notice","node","active","loading","string","error","isEmpty","getOnlyNumberInString","show","title","text","data","name","trim","Object","assign","message","send","chuyen_red","daily_list","regex","RegExp","user","forEach","daily","test","NICKNAME","bind","selectDaiLy","onChangerRed","onSelectHead","dailyStatus","onChangerNick","value","superT","numberWithCommas","valueT","nhan","Math","floor","phi","ceil","onClickOTP"],"mappings":"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","file":"ChuyenRed.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\Shop\\ChuyenRed","sourcesContent":["\r\nvar BrowserUtil = require('BrowserUtil');\r\nvar helper      = require('Helper');\r\n\r\ncc.Class({\r\n\textends: cc.Component,\r\n\r\n\tproperties: {\r\n\t\tnickname:  cc.EditBox,\r\n\t\tred:       cc.EditBox,\r\n\t\tmessenger: cc.EditBox,\r\n\t\totp:       cc.EditBox,\r\n\t\tredPhi:    cc.Label,\r\n\t\trednhan:   cc.Label,\r\n\t\tshop:      cc.Node,\r\n\t\tisdaily:  false,\r\n\t\tmeDaily:  false,\r\n\t},\r\n\tinit(obj){\r\n\t\tthis.RedT = obj;\r\n\t\tvar self = this;\r\n\r\n\t\tthis.editboxs = [this.nickname, this.red, this.messenger, this.otp];\r\n\t\tthis.keyHandle = function(t) {\r\n\t\t\treturn t.keyCode === cc.macro.KEY.tab ? (self.isTop() && self.changeNextFocusEditBox(),\r\n\t\t\t\tt.preventDefault && t.preventDefault(),\r\n\t\t\t\t!1) : t.keyCode === cc.macro.KEY.enter ? (BrowserUtil.focusGame(), self.onChuyenClick(),\r\n\t\t\t\tt.preventDefault && t.preventDefault(),\r\n\t\t\t\t!1) : void 0\r\n\t\t}\r\n\t},\r\n\tonEnable: function () {\r\n\t\tthis.reCheckMeDL();\r\n\t\tcc.sys.isBrowser && this.addEvent();\r\n\t\tthis.RedT.DaiLy.loadDaiLy();\r\n\t},\r\n\tonDisable: function () {\r\n\t\tcc.sys.isBrowser && this.removeEvent();\r\n\t\tthis.clean();\r\n\t},\r\n\taddEvent: function() {\r\n\t\tcc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t\tfor (var t in this.editboxs) {\r\n\t\t\tBrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).addEventListener(\"keydown\", this.keyHandle, !1)\r\n\t\t}\r\n\t},\r\n\tremoveEvent: function() {\r\n\t\tfor (var t in this.editboxs) {\r\n\t\t\tBrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).removeEventListener(\"keydown\", this.keyHandle, !1)\r\n\t\t}\r\n\t\tcc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t},\r\n\tonKeyDown: function (event) {\r\n\t\tswitch(event.keyCode) {\r\n\t\t\tcase cc.macro.KEY.tab:\r\n\t\t\t\tthis.isTop() && this.changeNextFocusEditBox();\r\n\t\t\t\tbreak;\r\n\t\t\tcase cc.macro.KEY.enter:\r\n\t\t\t\tthis.isTop() && this.onChuyenClick();\r\n\t\t}\r\n\t},\r\n\tchangeNextFocusEditBox: function() {\r\n\t\tfor (var t = !1, e = 0, i = this.editboxs.length; e < i; e++){\r\n            if (BrowserUtil.checkEditBoxFocus(this.editboxs[e])) {\r\n                BrowserUtil.focusEditBox(this.editboxs[e]);\r\n                t = !0;\r\n                break\r\n            }\r\n        }\r\n        !t && 0 < this.editboxs.length && BrowserUtil.focusEditBox(this.editboxs[0]);\r\n\t},\r\n\tisTop: function() {\r\n\t\treturn !cc.RedT.inGame.notice.node.active && !cc.RedT.inGame.loading.active;\r\n\t},\r\n\tclean: function(){\r\n\t\tthis.nickname.string = this.red.string = this.messenger.string = this.rednhan.string = this.redPhi.string = \"\";\r\n\t},\r\n\tonChuyenClick: function(){\r\n\t\tvar error = null;\r\n\t\tif(helper.isEmpty(this.nickname.string) ||\r\n\t\t\thelper.isEmpty(this.red.string))\r\n\t\t{\r\n\t\t\terror = \"Kiểm tra lại các thông tin...\"\r\n\t\t} else if(helper.isEmpty(this.nickname.string)){\r\n\t\t\terror = \"Tên nhân vật không được bỏ trống\"\r\n\t\t} else if(helper.getOnlyNumberInString(this.red.string) < 10000){\r\n\t\t\terror = \"Số tiền chuyển tối thiểu là 10.000.\"\r\n\t\t} else if(helper.isEmpty(this.otp.string)){\r\n\t\t\terror = \"Vui lòng nhập mã OTP.\"\r\n\t\t}\r\n\t\tif (error)\r\n\t\t\tcc.RedT.inGame.notice.show({title: \"\", text: error});\r\n\t\telse{\r\n\t\t\tvar data = {name:this.nickname.string, red:helper.getOnlyNumberInString(this.rednhan.string), otp:this.otp.string};\r\n\t\t\tif (!helper.isEmpty(this.messenger.string.trim())) {\r\n\t\t\t\tdata = Object.assign(data, {message: this.messenger.string});\r\n\t\t\t}\r\n\t\t\tcc.RedT.send({shop:{chuyen_red: data}});\r\n\t\t}\r\n\t},\r\n\treCheckMeDL: function(){\r\n\t\tthis.meDaily = false;\r\n\t\tif (this.RedT.DaiLy.daily_list.length) {\r\n\t\t\tlet regex = new RegExp(\"^\" + cc.RedT.user.name + \"$\", 'i');\r\n\t\t\tthis.RedT.DaiLy.daily_list.forEach(function(daily){\r\n\t\t\t\t!this.meDaily && (this.meDaily = regex.test(daily.NICKNAME.string));\r\n\t\t\t}.bind(this));\r\n\t\t}\r\n\t},\r\n\tselectDaiLy: function(daily){\r\n\t\tthis.isdaily  = true;\r\n\t\tthis.nickname.string = daily.NICKNAME.string;\r\n\t\tthis.onChangerRed(0, true);\r\n\t\tthis.RedT.onSelectHead(null, 'ChuyenRed');\r\n\t\tthis.dailyStatus();\r\n\t},\r\n\tonChangerNick: function(value){\r\n\t\tthis.isdaily = false;\r\n\t\tif (this.RedT.DaiLy.daily_list.length > 0) {\r\n\t\t\tthis.RedT.DaiLy.daily_list.forEach(function(obj){\r\n\t\t\t\tlet regex = new RegExp(\"^\" + value + \"$\", 'i');\r\n\t\t\t\tif (regex.test(obj.NICKNAME.string)) {\r\n\t\t\t\t\tthis.isdaily  = true;\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t}\r\n\t\tthis.onChangerRed(0, true);\r\n\t\tthis.dailyStatus();\r\n\t},\r\n\tonChangerRed: function(value = 0, superT = false){\r\n\t\tvalue = !!superT ? this.red.string : value;\r\n\t\tvalue = helper.numberWithCommas(helper.getOnlyNumberInString(value));\r\n\t\tthis.red.string = value == 0 ? \"\" : value;\r\n\t\tif(this.isdaily || this.meDaily){\r\n\t\t\tthis.rednhan.string = value;\r\n\t\t\tthis.redPhi.string = 0;\r\n\t\t}else{\r\n\t\t\tvar valueT = helper.getOnlyNumberInString(value);\r\n\t\t\tvar nhan = Math.floor(valueT);\r\n\t\t\tvar phi  = Math.ceil(valueT*2/100);\r\n\t\t\tthis.redPhi.string = helper.numberWithCommas(phi);\r\n\t\t\tthis.rednhan.string = helper.numberWithCommas(nhan+phi);\r\n\t\t}\r\n\t},\r\n\tdailyStatus: function(){\r\n\t\tif (this.isdaily) {\r\n\t\t\tthis.shop.active = true;\r\n\t\t}else{\r\n\t\t\tthis.shop.active = false;\r\n\t\t}\r\n\t},\r\n\tonClickOTP: function(){\r\n\t\tcc.RedT.send({otp:true});\r\n\t},\r\n});\r\n"]}