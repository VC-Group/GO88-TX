{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\SignIn/assets\\Script\\Model\\Dialog\\SignIn\\SignIn.js"],"names":["BrowserUtil","require","cc","Class","extends","Component","properties","username","EditBox","password","captcha","capchaSprite","Sprite","remember_me","Toggle","onLoad","self","yName","node","y","yPass","editboxs","editboxs_i","keyHandle","t","keyCode","macro","KEY","tab","changeNextFocusEditBox","preventDefault","enter","focusGame","onLoginClick","escape","RedT","inGame","dialog","onClickBack","onEnable","sys","isBrowser","addEvent","localStorage","getItem","isChecked","runAction","actionShow","onDisable","removeEvent","clean","resetSizeDialog","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","getHTMLElementByEditBox","addEventListener","removeEventListener","off","event","isTop","e","i","length","checkEditBoxFocus","focusEditBox","notice","active","loading","string","match","RegExp","show","title","text","auth","authentication","initCaptcha","o","Image","src","width","height","setTimeout","Texture2D","initWithElement","handleLoadedTexture","SpriteFrame","spriteFrame","bind","reCaptcha","send","RememberMeSet","setItem"],"mappings":";;;;;;AACA,IAAIA,cAAcC,QAAQ,aAAR,CAAlB;;AAEAC,GAAGC,KAAH,CAAS;AACRC,UAASF,GAAGG,SADJ;;AAGRC,aAAY;AACXC,YAAUL,GAAGM,OADF;AAEXC,YAAUP,GAAGM,OAFF;AAGXE,WAAUR,GAAGM,OAHF;AAIXG,gBAAcT,GAAGU,MAJN;AAKXC,eAAYX,GAAGY;AALJ,EAHJ;AAURC,OAVQ,oBAUE;AACT,MAAIC,OAAO,IAAX;AACA,OAAKC,KAAL,GAAa,KAAKV,QAAL,CAAcW,IAAd,CAAmBC,CAAhC;AACA,OAAKC,KAAL,GAAa,KAAKX,QAAL,CAAcS,IAAd,CAAmBC,CAAhC;AACA,OAAKE,QAAL,GAAgB,CAAC,KAAKd,QAAN,EAAgB,KAAKE,QAArB,CAAhB;AACA,OAAKa,UAAL,GAAkB,CAAlB;AACA,OAAKC,SAAL,GAAiB,UAASC,CAAT,EAAY;AAC5B,UAAOA,EAAEC,OAAF,KAAcvB,GAAGwB,KAAH,CAASC,GAAT,CAAaC,GAA3B,IAAkCZ,KAAKa,sBAAL,IACxCL,EAAEM,cAAF,IAAoBN,EAAEM,cAAF,EADoB,EAExC,CAAC,CAFK,IAEAN,EAAEC,OAAF,KAAcvB,GAAGwB,KAAH,CAASC,GAAT,CAAaI,KAA3B,IAAoC/B,YAAYgC,SAAZ,IAAyBhB,KAAKiB,YAAL,EAAzB,EAC1CT,EAAEM,cAAF,IAAoBN,EAAEM,cAAF,EADsB,EAE1C,CAAC,CAFK,IAEAN,EAAEC,OAAF,KAAcvB,GAAGwB,KAAH,CAASC,GAAT,CAAaO,MAA3B,IAAqChC,GAAGiC,IAAH,CAAQC,MAAR,CAAeC,MAAf,CAAsBC,WAAtB,IAC3Cd,EAAEM,cAAF,IAAoBN,EAAEM,cAAF,EADuB,EAE3C,CAAC,CAFK,IAEA,KAAK,CANZ;AAOA,GARD;AASA,EAzBO;;AA0BRS,WAAU,oBAAY;AACrBrC,KAAGsC,GAAH,CAAOC,SAAP,IAAoB,KAAKC,QAAL,EAApB;AACA,MAAI7B,cAAc8B,aAAaC,OAAb,CAAqB,aAArB,CAAlB;AACA,MAAG/B,eAAeA,eAAe,MAAjC,EAAwC;AACvC,QAAKA,WAAL,CAAiBgC,SAAjB,GAA6B,IAA7B;AACA;AACD,OAAK3B,IAAL,CAAU4B,SAAV,CAAoB5C,GAAGiC,IAAH,CAAQC,MAAR,CAAeC,MAAf,CAAsBU,UAA1C;AACA,EAjCO;AAkCRC,YAAW,qBAAY;AACtB9C,KAAGsC,GAAH,CAAOC,SAAP,IAAoB,KAAKQ,WAAL,EAApB;AACA,OAAKC,KAAL;AACAhD,KAAGiC,IAAH,CAAQC,MAAR,CAAeC,MAAf,CAAsBc,eAAtB,CAAsC,KAAKjC,IAA3C;AACA,EAtCO;AAuCRwB,WAAU,oBAAW;AACpBxC,KAAGkD,WAAH,CAAeC,EAAf,CAAkBnD,GAAGoD,WAAH,CAAeC,SAAf,CAAyBC,QAA3C,EAAqD,KAAKC,SAA1D,EAAqE,IAArE;AACA,OAAK,IAAIjC,CAAT,IAAc,KAAKH,QAAnB,EAA6B;AAC5BrB,eAAY0D,uBAAZ,CAAoC,KAAKrC,QAAL,CAAcG,CAAd,CAApC,EAAsDmC,gBAAtD,CAAuE,SAAvE,EAAkF,KAAKpC,SAAvF,EAAkG,CAAC,CAAnG;AACA;AACD,EA5CO;AA6CR0B,cAAa,uBAAW;AACvB,OAAK,IAAIzB,CAAT,IAAc,KAAKH,QAAnB,EAA6B;AAC5BrB,eAAY0D,uBAAZ,CAAoC,KAAKrC,QAAL,CAAcG,CAAd,CAApC,EAAsDoC,mBAAtD,CAA0E,SAA1E,EAAqF,KAAKrC,SAA1F,EAAqG,CAAC,CAAtG;AACA;AACDrB,KAAGkD,WAAH,CAAeS,GAAf,CAAmB3D,GAAGoD,WAAH,CAAeC,SAAf,CAAyBC,QAA5C,EAAsD,KAAKC,SAA3D,EAAsE,IAAtE;AACA,EAlDO;AAmDRA,YAAW,mBAAUK,KAAV,EAAiB;AAC3B,UAAOA,MAAMrC,OAAb;AACC,QAAKvB,GAAGwB,KAAH,CAASC,GAAT,CAAaO,MAAlB;AACC,SAAK6B,KAAL,MAAgB7D,GAAGiC,IAAH,CAAQC,MAAR,CAAeC,MAAf,CAAsBC,WAAtB,EAAhB;AACA;AACD,QAAKpC,GAAGwB,KAAH,CAASC,GAAT,CAAaC,GAAlB;AACC,SAAKmC,KAAL,MAAgB,KAAKlC,sBAAL,EAAhB;AACA;AACD,QAAK3B,GAAGwB,KAAH,CAASC,GAAT,CAAaI,KAAlB;AACC,SAAKgC,KAAL,MAAgB,KAAK9B,YAAL,EAAhB;AARF;AAUA,EA9DO;AA+DRJ,yBAAwB,kCAAW;AAClC,OAAK,IAAIL,IAAI,CAAC,CAAT,EAAYwC,IAAI,CAAhB,EAAmBC,IAAI,KAAK5C,QAAL,CAAc6C,MAA1C,EAAkDF,IAAIC,CAAtD,EAAyDD,GAAzD,EAA6D;AAC5D,OAAIhE,YAAYmE,iBAAZ,CAA8B,KAAK9C,QAAL,CAAc2C,CAAd,CAA9B,CAAJ,EAAqD;AACpDhE,gBAAYoE,YAAZ,CAAyB,KAAK/C,QAAL,CAAc2C,CAAd,CAAzB;AACAxC,QAAI,CAAC,CAAL;AACA;AACA;AACD;AACD,GAACA,CAAD,IAAM,IAAI,KAAKH,QAAL,CAAc6C,MAAxB,IAAkClE,YAAYoE,YAAZ,CAAyB,KAAK/C,QAAL,CAAc,CAAd,CAAzB,CAAlC;AACA,EAxEO;AAyER0C,QAAO,iBAAW;AACjB,SAAO,CAAC7D,GAAGiC,IAAH,CAAQC,MAAR,CAAeiC,MAAf,CAAsBnD,IAAtB,CAA2BoD,MAA5B,IAAsC,CAACpE,GAAGiC,IAAH,CAAQC,MAAR,CAAemC,OAAf,CAAuBD,MAArE;AACA,EA3EO;AA4ERpB,QAAO,iBAAU;AAChB,OAAK3C,QAAL,CAAcW,IAAd,CAAmBC,CAAnB,GAAuB,KAAKF,KAA5B;AACA,OAAKR,QAAL,CAAcS,IAAd,CAAmBC,CAAnB,GAAuB,KAAKC,KAA5B;AACA,OAAKb,QAAL,CAAciE,MAAd,GAAuB,KAAK/D,QAAL,CAAc+D,MAAd,GAAuB,EAA9C;AACA,OAAK9D,OAAL,CAAaQ,IAAb,CAAkBoD,MAAlB,GAA2B,KAA3B;AACA,EAjFO;AAkFRrC,eAAc,wBAAW;AACxB,MAAI,KAAK1B,QAAL,CAAciE,MAAd,CAAqBN,MAArB,GAA8B,EAA9B,IAAoC,KAAK3D,QAAL,CAAciE,MAAd,CAAqBN,MAArB,GAA8B,CAAlE,IAAuE,KAAK3D,QAAL,CAAciE,MAAd,CAAqBC,KAArB,CAA2B,IAAIC,MAAJ,CAAW,gBAAX,CAA3B,MAA6D,IAAxI,EAA6I;AAC5IxE,MAAGiC,IAAH,CAAQC,MAAR,CAAeiC,MAAf,CAAsBM,IAAtB,CAA2B,EAACC,OAAM,EAAP,EAAWC,MAAK,4BAAhB,EAA3B;AACA,GAFD,MAEO,IAAI,KAAKpE,QAAL,CAAc+D,MAAd,CAAqBN,MAArB,GAA8B,EAA9B,IAAoC,KAAKzD,QAAL,CAAc+D,MAAd,CAAqBN,MAArB,GAA8B,CAAtE,EAAwE;AAC9EhE,MAAGiC,IAAH,CAAQC,MAAR,CAAeiC,MAAf,CAAsBM,IAAtB,CAA2B,EAACC,OAAM,EAAP,EAAWC,MAAK,uBAAhB,EAA3B;AACA,GAFM,MAEF;AACJ,OAAI,KAAKnE,OAAL,CAAaQ,IAAb,CAAkBoD,MAAlB,KAA6B,IAAjC,EAAuC;AACtC,QAAI,KAAK5D,OAAL,CAAa8D,MAAb,CAAoBN,MAApB,GAA6B,CAA7B,IAAkC,KAAKxD,OAAL,CAAa8D,MAAb,CAAoBN,MAApB,GAA6B,CAAnE,EAAqE;AACpEhE,QAAGiC,IAAH,CAAQC,MAAR,CAAeiC,MAAf,CAAsBM,IAAtB,CAA2B,EAACC,OAAM,EAAP,EAAWC,MAAK,sBAAhB,EAA3B;AACA,KAFD,MAEK;AACJ3E,QAAGiC,IAAH,CAAQC,MAAR,CAAe0C,IAAf,CAAoB,EAACC,gBAAe,EAACxE,UAAS,KAAKA,QAAL,CAAciE,MAAxB,EAAgC/D,UAAS,KAAKA,QAAL,CAAc+D,MAAvD,EAA+D9D,SAAQ,KAAKA,OAAL,CAAa8D,MAApF,EAAhB,EAApB;AACA;AACD,IAND,MAMK;AACJtE,OAAGiC,IAAH,CAAQC,MAAR,CAAe0C,IAAf,CAAoB,EAACC,gBAAe,EAACxE,UAAS,KAAKA,QAAL,CAAciE,MAAxB,EAAgC/D,UAAS,KAAKA,QAAL,CAAc+D,MAAvD,EAAhB,EAApB;AACA;AACD;AACD,EAlGO;AAmGRQ,cAAa,qBAASxD,CAAT,EAAY;AACxB,OAAKjB,QAAL,CAAcW,IAAd,CAAmBC,CAAnB,GAAuB,KAAKF,KAAL,GAAW,EAAlC;AACA,OAAKR,QAAL,CAAcS,IAAd,CAAmBC,CAAnB,GAAuB,KAAKC,KAAL,GAAW,EAAlC;AACA,OAAKV,OAAL,CAAaQ,IAAb,CAAkBoD,MAAlB,GAA2B,IAA3B;AACA,MAAIW,IAAI,IAAIC,KAAJ,EAAR;AACAD,IAAEE,GAAF,GAAQ3D,CAAR;AACAyD,IAAEG,KAAF,GAAU,GAAV;AACAH,IAAEI,MAAF,GAAW,EAAX;AACAC,aAAW,YAAW;AACrB,OAAI9D,IAAI,IAAItB,GAAGqF,SAAP,EAAR;AACA/D,KAAEgE,eAAF,CAAkBP,CAAlB;AACAzD,KAAEiE,mBAAF;AACA,OAAIzB,IAAI,IAAI9D,GAAGwF,WAAP,CAAmBlE,CAAnB,CAAR;AACA,QAAKb,YAAL,CAAkBgF,WAAlB,GAAgC3B,CAAhC;AACA,GANU,CAMT4B,IANS,CAMJ,IANI,CAAX,EAMc,EANd;AAOA,EAlHO;AAmHRC,YAAW,qBAAU;AACpB3F,KAAGiC,IAAH,CAAQ2D,IAAR,CAAa,EAACpF,SAAS,QAAV,EAAb;AACA,EArHO;AAsHRqF,gBAAe,yBAAU;;AAExB,MAAG,KAAKlF,WAAL,CAAiBgC,SAApB,EAA8B;AAC7BF,gBAAaqD,OAAb,CAAqB,aAArB,EAAmC,IAAnC;AACA,GAFD,MAEK;AACJrD,gBAAaqD,OAAb,CAAqB,aAArB,EAAmC,KAAnC;AACA;AACD;AA7HO,CAAT","file":"SignIn.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\SignIn","sourcesContent":["\r\nvar BrowserUtil = require('BrowserUtil');\r\n\r\ncc.Class({\r\n\textends: cc.Component,\r\n\r\n\tproperties: {\r\n\t\tusername: cc.EditBox,\r\n\t\tpassword: cc.EditBox,\r\n\t\tcaptcha:  cc.EditBox,\r\n\t\tcapchaSprite: cc.Sprite,\r\n\t\tremember_me:cc.Toggle\r\n\t},\r\n\tonLoad () {\r\n\t\tvar self = this;\r\n\t\tthis.yName = this.username.node.y;\r\n\t\tthis.yPass = this.password.node.y;\r\n\t\tthis.editboxs = [this.username, this.password];\r\n\t\tthis.editboxs_i = 0;\r\n\t\tthis.keyHandle = function(t) {\r\n\t\t\treturn t.keyCode === cc.macro.KEY.tab ? (self.changeNextFocusEditBox(),\r\n\t\t\t\tt.preventDefault && t.preventDefault(),\r\n\t\t\t\t!1) : t.keyCode === cc.macro.KEY.enter ? (BrowserUtil.focusGame(), self.onLoginClick(),\r\n\t\t\t\tt.preventDefault && t.preventDefault(),\r\n\t\t\t\t!1) : t.keyCode === cc.macro.KEY.escape ? (cc.RedT.inGame.dialog.onClickBack(),\r\n\t\t\t\tt.preventDefault && t.preventDefault(),\r\n\t\t\t\t!1) : void 0\r\n\t\t}\r\n\t},\r\n\tonEnable: function () {\r\n\t\tcc.sys.isBrowser && this.addEvent();\r\n\t\tvar remember_me = localStorage.getItem(\"remember_me\");\r\n\t\tif(remember_me && remember_me == \"true\"){\r\n\t\t\tthis.remember_me.isChecked = true;\r\n\t\t}\r\n\t\tthis.node.runAction(cc.RedT.inGame.dialog.actionShow);\r\n\t},\r\n\tonDisable: function () {\r\n\t\tcc.sys.isBrowser && this.removeEvent();\r\n\t\tthis.clean();\r\n\t\tcc.RedT.inGame.dialog.resetSizeDialog(this.node);\r\n\t},\r\n\taddEvent: function() {\r\n\t\tcc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t\tfor (var t in this.editboxs) {\r\n\t\t\tBrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).addEventListener(\"keydown\", this.keyHandle, !1)\r\n\t\t}\r\n\t},\r\n\tremoveEvent: function() {\r\n\t\tfor (var t in this.editboxs) {\r\n\t\t\tBrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).removeEventListener(\"keydown\", this.keyHandle, !1)\r\n\t\t}\r\n\t\tcc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t},\r\n\tonKeyDown: function (event) {\r\n\t\tswitch(event.keyCode) {\r\n\t\t\tcase cc.macro.KEY.escape:\r\n\t\t\t\tthis.isTop() && cc.RedT.inGame.dialog.onClickBack();\r\n\t\t\t\tbreak;\r\n\t\t\tcase cc.macro.KEY.tab:\r\n\t\t\t\tthis.isTop() && this.changeNextFocusEditBox();\r\n\t\t\t\tbreak;\r\n\t\t\tcase cc.macro.KEY.enter:\r\n\t\t\t\tthis.isTop() && this.onLoginClick();\r\n\t\t}\r\n\t},\r\n\tchangeNextFocusEditBox: function() {\r\n\t\tfor (var t = !1, e = 0, i = this.editboxs.length; e < i; e++){\r\n\t\t\tif (BrowserUtil.checkEditBoxFocus(this.editboxs[e])) {\r\n\t\t\t\tBrowserUtil.focusEditBox(this.editboxs[e]);\r\n\t\t\t\tt = !0;\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t\t!t && 0 < this.editboxs.length && BrowserUtil.focusEditBox(this.editboxs[0]);\r\n\t},\r\n\tisTop: function() {\r\n\t\treturn !cc.RedT.inGame.notice.node.active && !cc.RedT.inGame.loading.active;\r\n\t},\r\n\tclean: function(){\r\n\t\tthis.username.node.y = this.yName;\r\n\t\tthis.password.node.y = this.yPass;\r\n\t\tthis.username.string = this.password.string = '';\r\n\t\tthis.captcha.node.active = false;\r\n\t},\r\n\tonLoginClick: function() {\r\n\t\tif (this.username.string.length > 32 || this.username.string.length < 3 || this.username.string.match(new RegExp(\"^[a-zA-Z0-9]+$\")) === null){\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"\", text:'Tên tài khoản không đúng!!'});\r\n\t\t} else if (this.password.string.length > 32 || this.password.string.length < 6){\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"\", text:'Mật khẩu không đúng!!'});\r\n\t\t}else{\r\n\t\t\tif (this.captcha.node.active === true) {\r\n\t\t\t\tif (this.captcha.string.length > 6 || this.captcha.string.length < 4){\r\n\t\t\t\t\tcc.RedT.inGame.notice.show({title:\"\", text:'Captcha không đúng!!'});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tcc.RedT.inGame.auth({authentication:{username:this.username.string, password:this.password.string, captcha:this.captcha.string}});\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tcc.RedT.inGame.auth({authentication:{username:this.username.string, password:this.password.string}});\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tinitCaptcha: function(t) {\r\n\t\tthis.username.node.y = this.yName+45;\r\n\t\tthis.password.node.y = this.yPass+52;\r\n\t\tthis.captcha.node.active = true;\r\n\t\tlet o = new Image;\r\n\t\to.src = t;\r\n\t\to.width = 150;\r\n\t\to.height = 50;\r\n\t\tsetTimeout(function() {\r\n\t\t\tlet t = new cc.Texture2D;\r\n\t\t\tt.initWithElement(o);\r\n\t\t\tt.handleLoadedTexture();\r\n\t\t\tlet e = new cc.SpriteFrame(t);\r\n\t\t\tthis.capchaSprite.spriteFrame = e;\r\n\t\t}.bind(this), 10)\r\n\t},\r\n\treCaptcha: function(){\r\n\t\tcc.RedT.send({captcha: 'signIn'});\r\n\t},\r\n\tRememberMeSet: function(){\r\n\t\t \r\n\t\tif(this.remember_me.isChecked){\r\n\t\t\tlocalStorage.setItem('remember_me',true);\r\n\t\t}else{\r\n\t\t\tlocalStorage.setItem('remember_me',false);\r\n\t\t}\r\n\t}\r\n});\r\n"]}