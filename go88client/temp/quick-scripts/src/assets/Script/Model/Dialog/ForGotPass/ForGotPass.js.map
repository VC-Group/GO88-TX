{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\ForGotPass/assets\\Script\\Model\\Dialog\\ForGotPass\\ForGotPass.js"],"names":["BrowserUtil","require","helper","cc","Class","extends","Component","properties","username","default","type","EditBox","newpass","renewpass","otp","captcha","capchaSprite","Sprite","onLoad","self","editboxs","keyHandle","t","keyCode","macro","KEY","tab","changeNextFocusEditBox","preventDefault","enter","focusGame","onForGotClick","escape","RedT","inGame","dialog","onClickBack","onEnable","sys","isBrowser","addEvent","node","runAction","actionShow","reCaptcha","onDisable","removeEvent","clean","resetSizeDialog","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","getHTMLElementByEditBox","addEventListener","removeEventListener","off","event","isTop","e","i","length","checkEditBoxFocus","focusEditBox","notice","active","loading","string","show","title","text","match","RegExp","send","forgotpass","iforgot","name","pass","initCaptcha","o","Image","src","width","height","setTimeout","Texture2D","initWithElement","handleLoadedTexture","SpriteFrame","spriteFrame","onClickOTP","trim","sendOTP"],"mappings":"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","file":"ForGotPass.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\ForGotPass","sourcesContent":["\r\nvar BrowserUtil = require('BrowserUtil');\r\n\r\nvar helper = require('Helper');\r\n\r\ncc.Class({\r\n\textends: cc.Component,\r\n\r\n\tproperties: {\r\n\t\tusername: {\r\n\t\t\tdefault: null,\r\n\t\t\ttype: cc.EditBox,\r\n\t\t},\r\n\t\tnewpass: {\r\n\t\t\tdefault: null,\r\n\t\t\ttype: cc.EditBox,\r\n\t\t},\r\n\t\trenewpass: {\r\n\t\t\tdefault: null,\r\n\t\t\ttype: cc.EditBox,\r\n\t\t},\r\n\t\totp: {\r\n\t\t\tdefault: null,\r\n\t\t\ttype: cc.EditBox,\r\n\t\t},\r\n\t\tcaptcha: {\r\n\t\t\tdefault: null,\r\n\t\t\ttype: cc.EditBox,\r\n\t\t},\r\n\t\tcapchaSprite: cc.Sprite,\r\n\t},\r\n\tonLoad () {\r\n\t\tvar self = this;\r\n\t\tthis.editboxs = [this.username, this.newpass, this.renewpass, this.otp, this.captcha];\r\n\t\tthis.keyHandle = function(t) {\r\n\t\t\treturn t.keyCode === cc.macro.KEY.tab ? (self.changeNextFocusEditBox(),\r\n\t\t\t\tt.preventDefault && t.preventDefault(),\r\n\t\t\t\t!1) : t.keyCode === cc.macro.KEY.enter ? (BrowserUtil.focusGame(), self.onForGotClick(),\r\n\t\t\t\tt.preventDefault && t.preventDefault(),\r\n\t\t\t\t!1) : t.keyCode === cc.macro.KEY.escape ? (cc.RedT.inGame.dialog.onClickBack(),\r\n\t\t\t\tt.preventDefault && t.preventDefault(),\r\n\t\t\t\t!1) : void 0\r\n\t\t}\r\n\t},\r\n\tonEnable: function () {\r\n\t\tcc.sys.isBrowser && this.addEvent();\r\n\t\tthis.node.runAction(cc.RedT.inGame.dialog.actionShow);\r\n\t\tthis.reCaptcha();\r\n\t},\r\n\tonDisable: function () {\r\n\t\tcc.sys.isBrowser && this.removeEvent();\r\n\t\tthis.clean();\r\n\t\tcc.RedT.inGame.dialog.resetSizeDialog(this.node);\r\n\t},\r\n\taddEvent: function() {\r\n\t\tcc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t\tfor (var t in this.editboxs) {\r\n\t\t\tBrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).addEventListener(\"keydown\", this.keyHandle, !1)\r\n\t\t}\r\n\t},\r\n\tremoveEvent: function() {\r\n\t\tfor (var t in this.editboxs) {\r\n\t\t\tBrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).removeEventListener(\"keydown\", this.keyHandle, !1)\r\n\t\t}\r\n\t\tcc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t},\r\n\tonKeyDown: function (event) {\r\n\t\tswitch(event.keyCode) {\r\n\t\t\tcase cc.macro.KEY.escape:\r\n\t\t\t\tthis.isTop() && cc.RedT.inGame.dialog.onClickBack();\r\n\t\t\t\tbreak;\r\n\t\t\tcase cc.macro.KEY.tab:\r\n\t\t\t\tthis.isTop() && this.changeNextFocusEditBox();\r\n\t\t\t\tbreak;\r\n\t\t\tcase cc.macro.KEY.enter:\r\n\t\t\t\tthis.isTop() && this.onForGotClick();\r\n\t\t}\r\n\t},\r\n\tchangeNextFocusEditBox: function() {\r\n\t\tfor (var t = !1, e = 0, i = this.editboxs.length; e < i; e++){\r\n            if (BrowserUtil.checkEditBoxFocus(this.editboxs[e])) {\r\n                BrowserUtil.focusEditBox(this.editboxs[e]);\r\n                t = !0;\r\n                break\r\n            }\r\n        }\r\n        !t && 0 < this.editboxs.length && BrowserUtil.focusEditBox(this.editboxs[0]);\r\n\t},\r\n\tisTop: function() {\r\n\t\treturn !cc.RedT.inGame.notice.node.active && !cc.RedT.inGame.loading.active;\r\n\t},\r\n\tclean: function(){\r\n\t\tthis.username.string = this.newpass.string = this.renewpass.string = this.otp.string = this.captcha.string = '';\r\n\t},\r\n\tonForGotClick: function() {\r\n\t\tif (this.username.string.length < 3 || this.username.string.length > 32) {\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"LỖI\", text:'Vui lòng nhập chính xác tên tài khoản...'});\r\n\t\t} else if (this.username.string.match(new RegExp(\"^[a-zA-Z0-9]+$\")) === null){\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"LỖI\", text:'Tên tài khoản chỉ gồm Chữ và Số!'});\r\n\t\t} else if (this.newpass.string.length < 6 || this.newpass.string.length > 32) {\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"LỖI\", text:'Độ dài mật khẩu tối thiểu 6-32 kí tự...'});\r\n\t\t} else if (this.newpass.string.length != this.renewpass.string.length) {\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"LỖI\", text:'Nhập lại mật khẩu không đúng...'});\r\n\t\t} else if (this.otp.string.length != 4){\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"LỖI\", text:'Mã OTP không hợp lệ...'});\r\n\t\t} else if (this.captcha.string.length != 4){\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"LỖI\", text:'Captcha không đúng.'});\r\n\t\t}else{\r\n\t\t\tcc.RedT.send({forgotpass:{iforgot: {name: this.username.string, pass: this.newpass.string, otp: this.otp.string, captcha: this.captcha.string}}});\r\n\t\t}\r\n\t},\r\n\tinitCaptcha: function(t) {\r\n\t\tvar i = this\r\n\t\t  , o = new Image;\r\n\t\to.src = t,\r\n\t\to.width = 150,\r\n\t\to.height = 50,\r\n\t\tsetTimeout(function() {\r\n\t\t\tvar t = new cc.Texture2D;\r\n\t\t\tt.initWithElement(o),\r\n\t\t\tt.handleLoadedTexture();\r\n\t\t\tvar e = new cc.SpriteFrame(t);\r\n\t\t\ti.capchaSprite.spriteFrame = e\r\n\t\t}, 10)\r\n\t},\r\n\treCaptcha: function(){\r\n\t\tcc.RedT.send({captcha: 'forgotpass'});\r\n\t},\r\n\tonClickOTP: function(){\r\n\t\tvar username = this.username.string.trim();\r\n\t\tif (this.username.string.length < 3 || this.username.string.length > 32) {\r\n\t\t\tcc.RedT.inGame.notice.show({title:\"\", text:'Vui lòng nhập chính xác tên tài khoản...'});\r\n\t\t}else{\r\n\t\t\tcc.RedT.send({forgotpass:{sendOTP: this.username.string}});\r\n\t\t}\r\n\t},\r\n});\r\n"]}