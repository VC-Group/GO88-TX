{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\Shop\\TieuRed\\MuaXu/assets\\Script\\Model\\Dialog\\Shop\\TieuRed\\MuaXu\\shopMuaXu.js"],"names":["helper","require","BrowserUtil","cc","Class","extends","Component","properties","xu","default","type","Label","red","EditBox","captcha","capchaSprite","Sprite","onLoad","self","editboxs","keyHandle","t","keyCode","macro","KEY","tab","changeNextFocusEditBox","preventDefault","enter","focusGame","onClickMua","onEnable","sys","isBrowser","addEvent","reCaptcha","onDisable","removeEvent","clean","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","getHTMLElementByEditBox","addEventListener","removeEventListener","off","event","isTop","e","i","length","checkEditBoxFocus","focusEditBox","RedT","inGame","notice","node","active","loading","string","onChanger","value","getOnlyNumberInString","valueRed","numberWithCommas","parseInt","isEmpty","show","title","text","send","shop","mua_xu","initCaptcha","o","Image","src","width","height","setTimeout","Texture2D","initWithElement","handleLoadedTexture","SpriteFrame","spriteFrame"],"mappings":"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","file":"shopMuaXu.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Model\\Dialog\\Shop\\TieuRed\\MuaXu","sourcesContent":["\r\nvar helper      = require('Helper');\r\nvar BrowserUtil = require('BrowserUtil');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        xu: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        red: {\r\n            default: null,\r\n            type: cc.EditBox,\r\n        },\r\n        captcha: {\r\n            default: null,\r\n            type: cc.EditBox,\r\n        },\r\n        capchaSprite: cc.Sprite,\r\n    },\r\n    onLoad(){\r\n        var self = this;\r\n        this.editboxs = [this.red, this.captcha];\r\n        this.keyHandle = function(t) {\r\n            return t.keyCode === cc.macro.KEY.tab ? (self.changeNextFocusEditBox(),\r\n                t.preventDefault && t.preventDefault(),\r\n                !1) : t.keyCode === cc.macro.KEY.enter ? (BrowserUtil.focusGame(), self.onClickMua(),\r\n                t.preventDefault && t.preventDefault(),\r\n                !1) : void 0\r\n        }\r\n    },\r\n    onEnable: function () {\r\n        cc.sys.isBrowser && this.addEvent();\r\n        this.reCaptcha();\r\n    },\r\n    onDisable: function () {\r\n        cc.sys.isBrowser && this.removeEvent();\r\n        this.clean();\r\n    },\r\n    addEvent: function() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        for (var t in this.editboxs) {\r\n            BrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).addEventListener(\"keydown\", this.keyHandle, !1)\r\n        }\r\n    },\r\n    removeEvent: function() {\r\n        for (var t in this.editboxs) {\r\n            BrowserUtil.getHTMLElementByEditBox(this.editboxs[t]).removeEventListener(\"keydown\", this.keyHandle, !1)\r\n        }\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n    },\r\n    onKeyDown: function (event) {\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.tab:\r\n                this.isTop() && this.changeNextFocusEditBox();\r\n                break;\r\n            case cc.macro.KEY.enter:\r\n                this.isTop() && this.onClickMua();\r\n        }\r\n    },\r\n    changeNextFocusEditBox: function() {\r\n        for (var t = !1, e = 0, i = this.editboxs.length; e < i; e++){\r\n            if (BrowserUtil.checkEditBoxFocus(this.editboxs[e])) {\r\n                BrowserUtil.focusEditBox(this.editboxs[e]);\r\n                t = !0;\r\n                break\r\n            }\r\n        }\r\n        !t && 0 < this.editboxs.length && BrowserUtil.focusEditBox(this.editboxs[0]);\r\n    },\r\n    isTop: function() {\r\n        return !cc.RedT.inGame.notice.node.active && !cc.RedT.inGame.loading.active;\r\n    },\r\n    clean: function(){\r\n        this.red.string = this.xu.string = this.captcha.string = '';\r\n    },\r\n    onChanger: function(red) {\r\n        var value    = helper.getOnlyNumberInString(red);\r\n        var valueRed = helper.numberWithCommas(value);\r\n\r\n        this.xu.string  = helper.numberWithCommas(value*3);\r\n        this.red.string = valueRed == \"0\" ? \"\" : valueRed;\r\n    },\r\n    onClickMua: function() {\r\n        if (parseInt(helper.isEmpty(this.red.string) || helper.getOnlyNumberInString(this.red.string)) < 1000) {\r\n            cc.RedT.inGame.notice.show({title: \"\", text: \"Số RED mua XU tối thiểu là 1.000\"})\r\n        }else if(helper.isEmpty(this.captcha.string)){\r\n            cc.RedT.inGame.notice.show({title: \"\", text: \"Vui lòng nhập chính xác mã xác nhận.\"})\r\n        }else{\r\n            cc.RedT.send({shop:{mua_xu:{red: helper.getOnlyNumberInString(this.red.string), captcha: this.captcha.string}}});\r\n        }\r\n    },\r\n    initCaptcha: function(t) {\r\n        var i = this\r\n          , o = new Image;\r\n        o.src = t,\r\n        o.width = 150,\r\n        o.height = 50,\r\n        setTimeout(function() {\r\n            var t = new cc.Texture2D;\r\n            t.initWithElement(o),\r\n            t.handleLoadedTexture();\r\n            var e = new cc.SpriteFrame(t);\r\n            i.capchaSprite.spriteFrame = e\r\n        }, 10)\r\n    },\r\n    reCaptcha: function(){\r\n        cc.RedT.send({captcha: 'withdrawXu'});\r\n    },\r\n});\r\n"]}