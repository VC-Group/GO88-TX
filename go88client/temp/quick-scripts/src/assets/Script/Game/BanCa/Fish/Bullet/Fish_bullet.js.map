{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Game\\BanCa\\Fish\\Bullet/assets\\Script\\Game\\BanCa\\Fish\\Bullet\\Fish_bullet.js"],"names":["cc","Class","extends","Component","properties","body","RigidBody","collider","PhysicsCircleCollider","icon","Node","isMe","isLock","bullet","init","obj","target","RedT","x","y","node","selfX","selfY","velocity","v2","normalizeSelf","mulSelf","Game","bulletVelocity","linearVelocity","positionUser","parent","convertToWorldSpaceAR","position1_1","convertToNodeSpaceAR","misc","radiansToDegrees","Math","atan2","angle","updateGroup","onPostSolve","vecNew","onCollisionEnter","other","group","id","ef_bullet","instantiate","nodeDan","addChild","destroy","send","g","fish","collision","f","map"],"mappings":"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","file":"Fish_bullet.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Game\\BanCa\\Fish\\Bullet","sourcesContent":["\r\ncc.Class({\r\n\textends: cc.Component,\r\n\r\n\tproperties: {\r\n\t\tbody:     cc.RigidBody,\r\n\t\tcollider: cc.PhysicsCircleCollider,\r\n\t\ticon:     cc.Node,\r\n\t\tisMe:     false,\r\n\t\tisLock:   false,\r\n\t\tbullet:   0,\r\n\t},\r\n\tinit: function(obj, target){\r\n\t\tthis.RedT = obj;\r\n\r\n        var x = target.x;\r\n        var y = target.y;\r\n\r\n\t\tthis.node.x = this.RedT.node.x;\r\n\t\tthis.node.y = this.RedT.node.y;\r\n\r\n        var selfX = this.node.x;\r\n        var selfY = this.node.y;\r\n\r\n        var velocity = cc.v2(x-selfX, y-selfY);\r\n        velocity.normalizeSelf();\r\n        velocity.mulSelf(this.RedT.RedT.Game.bulletVelocity);\r\n\r\n        this.body.linearVelocity = velocity;\r\n\r\n        let positionUser = this.RedT.node.parent.convertToWorldSpaceAR(target);\r\n\t\tlet position1_1  = this.RedT.node.convertToNodeSpaceAR(positionUser);\r\n\t\tposition1_1 = cc.misc.radiansToDegrees(Math.atan2(position1_1.x, position1_1.y));\r\n\t\tthis.icon.angle = -position1_1;\r\n\r\n\t\tthis.updateGroup();\r\n\t},\r\n    onPostSolve: function () {\r\n\t\tlet vecNew = this.body.linearVelocity;\r\n\t\tvecNew = cc.misc.radiansToDegrees(Math.atan2(vecNew.x, vecNew.y));\r\n\t\tthis.icon.angle = -vecNew;\r\n    },\r\n\tonCollisionEnter: function(other) {\r\n\t\tif (other.node.group !== 'tuong') {\r\n\t\t\tif (void 0 !== this.id) {\r\n\t\t\t\tdelete this.RedT.bullet[this.id];\r\n\t\t\t}\r\n\t\t\tlet ef_bullet = cc.instantiate(this.RedT.RedT.Game.ef_bullet[this.bullet]);\r\n\t\t\tef_bullet.x = this.node.x;\r\n\t\t\tef_bullet.y = this.node.y;\r\n\t\t\tthis.RedT.RedT.Game.nodeDan.addChild(ef_bullet);\r\n\t\t\tthis.node.destroy();\r\n\t\t\tif (this.isMe) {\r\n\t\t\t\tcc.RedT.send({g:{fish:{collision:{id:this.id, f:other.node.id}}}});\r\n\t\t\t}\r\n\t\t}\r\n    },\r\n\tupdateGroup: function() {\r\n\t\tlet group = 'dan';\r\n\t\tif(this.node) {\r\n\t\t\tif (this.isLock){\r\n\t\t\t\tgroup += this.RedT.map;\r\n\t\t\t}\r\n\t\t\tthis.node.group = group;\r\n\t\t\t//console.log(this.node.group);\r\n\t\t}\r\n\t},\r\n});\r\n"]}