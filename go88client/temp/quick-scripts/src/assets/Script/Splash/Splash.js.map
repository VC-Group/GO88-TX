{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\Splash/assets\\Script\\Splash\\Splash.js"],"names":["cc","Class","extends","Component","properties","messageLabel","Label","manifestUrl","default","type","Asset","retryButtonNode","Node","updateProgressBar","star","_am","_updating","_canRetry","_storagePath","onLoad","isLoadScene","isLoadConfig","initOneSign","sys","isBrowser","loadAssets","initHotUpdate","checkUpdate","checkPlugin","sdkbox","PluginOneSignal","init","setListener","onSendTag","t","e","i","onGetTags","onIdsAvailable","onPostNotification","onNotification","console","log","updateProgress","string","setTimeout","loadScene","bind","director","preloadScene","onProgress","onLoaded","completedCount","totalCount","RedT","err","asset","onDestroy","_updateListener","setEventCallback","jsb","fileUtils","getWritablePath","AssetsManager","versionCompareHandle","setVerifyCallback","compressed","os","OS_ANDROID","setMaxConcurrentTask","getState","State","UNINITED","loadLocalManifest","nativeUrl","checkCb","hotUpdate","updateCb","_failCount","update","retry","active","downloadFailedAssets","getEventCode","EventAssetsManager","ERROR_NO_LOCAL_MANIFEST","ERROR_DOWNLOAD_MANIFEST","ERROR_PARSE_MANIFEST","ALREADY_UP_TO_DATE","NEW_VERSION_FOUND","_checkListener","event","needRestart","failed","UPDATE_PROGRESSION","getPercent","UPDATE_FINISHED","UPDATE_FAILED","ERROR_UPDATING","ERROR_DECOMPRESS","getMessage","searchPaths","getSearchPaths","newPaths","getLocalManifest","Array","prototype","unshift","apply","localStorage","setItem","JSON","stringify","setSearchPaths","audioEngine","stopAll","game","restart","onRetryClick","split","o","n","length","s","parseInt","a","progress","width","position","v2"],"mappings":"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","file":"Splash.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Splash","sourcesContent":["\r\ncc.Class({\r\n\textends: cc.Component,\r\n\tproperties: {\r\n\t\tmessageLabel: cc.Label,\r\n\t\tmanifestUrl: {\r\n\t\t\tdefault: null,\r\n\t\t\ttype: cc.Asset,\r\n\t\t},\r\n\t\tretryButtonNode:   cc.Node,\r\n\t\tupdateProgressBar: cc.Node,\r\n\t\tstar:              cc.Node,\r\n\t\t_am: null,\r\n\t\t_updating: !1,\r\n\t\t_canRetry: !1,\r\n\t\t_storagePath: \"\"\r\n\t},\r\n\tonLoad: function() {\r\n\t\tthis.isLoadScene  = !1;\r\n\t\tthis.isLoadConfig = !1;\r\n\t\tthis.initOneSign();\r\n\t\tcc.sys.isBrowser ? this.loadAssets() : (this.initHotUpdate(), this.checkUpdate());\r\n\t},\r\n\tinitOneSign: function() {\r\n\t\tthis.checkPlugin() && (sdkbox.PluginOneSignal.init(),\r\n\t\tsdkbox.PluginOneSignal.setListener({\r\n\t\t\tonSendTag: function(t, e, i) {},\r\n\t\t\tonGetTags: function(t) {},\r\n\t\t\tonIdsAvailable: function(t, e) {},\r\n\t\t\tonPostNotification: function(t, e) {},\r\n\t\t\tonNotification: function(t, e, i) {}\r\n\t\t}))\r\n\t},\r\n\tcheckPlugin: function() {\r\n\t\treturn \"undefined\" == typeof sdkbox ? (console.log(\"sdkbox is undefined\"),\r\n\t\t!1) : void 0 !== sdkbox.PluginOneSignal || (console.log(\"sdkbox.PluginFacebook is undefined\"),\r\n\t\t!1)\r\n\t},\r\n\tloadAssets: function() {\r\n\t\tthis.updateProgress(0);\r\n\t\tthis.messageLabel.string = \"Đang lấy dữ liệu game ...\";\r\n\t\tsetTimeout(function(){\r\n\t\t\tthis.loadScene();\r\n\t\t}.bind(this), 100);\r\n\t},\r\n\tloadScene: function() {\r\n\t\tcc.director.preloadScene(\"MainGame\", this.onProgress.bind(this), this.onLoaded.bind(this));\r\n\t},\r\n\tonProgress: function(completedCount, totalCount){\r\n\t\t// đang tải cảnh\r\n\t\tvar RedT = ((completedCount/totalCount)*838)>>0;\r\n\t\tthis.updateProgress(RedT);\r\n\t},\r\n\tonLoaded: function(err, asset){\r\n\t\t// Tải cảnh thành công\r\n\t\tcc.director.loadScene(\"MainGame\");\r\n\t},\r\n\tonDestroy: function() {\r\n\t\tif (this._updateListener) {\r\n\t\t\tthis._am.setEventCallback(null);\r\n\t\t\tthis._updateListener = null;\r\n\t\t}\r\n\t},\r\n\tinitHotUpdate: function() {\r\n\t\tthis.updateProgress(0);\r\n\t\tthis._storagePath = (jsb.fileUtils ? jsb.fileUtils.getWritablePath() : \"/\") + \"go88-remote-asset\";\r\n\t\tthis._am = new jsb.AssetsManager(\"\", this._storagePath, this.versionCompareHandle);\r\n\t\tthis._am.setVerifyCallback(function(t, e) {\r\n\t\t\te.compressed;\r\n\t\t\treturn !0\r\n\t\t}\r\n\t\t.bind(this));\r\n\t\tcc.sys.os === cc.sys.OS_ANDROID && this._am.setMaxConcurrentTask(2);\r\n\t},\r\n\tcheckUpdate: function() {\r\n\t\tif (this._updating) {\r\n\t\t\tthis.messageLabel.string = \"Đang kiểm tra phiên bản ...\";\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._am.getState() === jsb.AssetsManager.State.UNINITED) {\r\n\t\t\tthis._am.loadLocalManifest(this.manifestUrl.nativeUrl);\r\n\t\t}\r\n\r\n\t\tthis._am.setEventCallback(this.checkCb.bind(this));\r\n\t\tthis._am.checkUpdate();\r\n\t\tthis._updating = true;\r\n\t},\r\n\thotUpdate: function() {\r\n\t\tif (this._am && !this._updating) {\r\n\t\t\tthis._am.setEventCallback(this.updateCb.bind(this));\r\n\r\n\t\t\tif (this._am.getState() === jsb.AssetsManager.State.UNINITED) {\r\n\t\t\t\tthis._am.loadLocalManifest(this.manifestUrl.nativeUrl);\r\n\t\t\t}\r\n\t\t\tthis._failCount = 0;\r\n\t\t\tthis._am.update();\r\n\t\t\tthis._updating = true;\r\n\t\t}\r\n\t},\r\n\tretry: function() {\r\n\t\t!this._updating && this._canRetry && (this.retryButtonNode.active = !1,\r\n\t\tthis._canRetry = !1,\r\n\t\tthis.messageLabel.string = \"Thử lại ...\",\r\n\t\tthis._am.downloadFailedAssets())\r\n\t},\r\n\tcheckCb: function(t) {\r\n\t\tvar e = !1\r\n\t\t  , i = !1;\r\n\t\tswitch (t.getEventCode()) {\r\n\t\tcase jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\r\n\t\t\tthis.messageLabel.string = \"Không tìm thấy Hot Update ...\";\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\r\n\t\tcase jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\r\n\t\t\tthis.messageLabel.string = \"Tải manifest thất bại ...\";\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\r\n\t\t\tthis.updateProgress(838);\r\n\t\t\tthis.messageLabel.string = \"Phiên bản mới nhất ...\";\r\n\t\t\te = !0;\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.NEW_VERSION_FOUND:\r\n\t\t\tthis.messageLabel.string = \"Tìm thấy phiên bản cập nhật ...\";\r\n\t\t\tthis.updateProgress(0);\r\n\t\t\ti = true;\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis._am.setEventCallback(null);\r\n\t\tthis._checkListener = null;\r\n\t\tthis._updating = !1;\r\n\t\te && this.loadAssets();\r\n\t\ti && (this.hotUpdate());\r\n\t},\r\n\tupdateCb: function(event) {\r\n\t\tvar needRestart = false;\r\n\t\tvar failed      = false;\r\n\t\tswitch (event.getEventCode()) {\r\n\t\tcase jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\r\n\t\t\tthis.messageLabel.string = \"Không tìm thấy Hot Update ...\";\r\n\t\t\tfailed = true;\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.UPDATE_PROGRESSION:\r\n\t\t\tvar RedT = event.getPercent()*838;\r\n\t\t\tthis.updateProgress(RedT);\r\n\t\t\t//event.getMessage();\r\n\t\t\tthis.messageLabel.string = \"Đang cập nhật ...\";\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\r\n\t\tcase jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\r\n\t\t\tthis.messageLabel.string = \"Tải manifest thất bại ...\";\r\n\t\t\tfailed = true;\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\r\n\t\t\tthis.updateProgress(838);\r\n\t\t\tthis.messageLabel.string = \"Phiên bản mới nhất ...\";\r\n\t\t\tfailed = true;\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.UPDATE_FINISHED:\r\n\t\t\tthis.messageLabel.string = \"Cập nhật thành công\";\r\n\t\t\tneedRestart = true;\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.UPDATE_FAILED:\r\n\t\t\tthis.messageLabel.string = \"Cập nhật thất bại\";\r\n\t\t\tthis.retryButtonNode.active = !0;\r\n\t\t\tthis._updating = !1;\r\n\t\t\tthis._canRetry = !0;\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.ERROR_UPDATING:\r\n\t\t\tthis.messageLabel.string = \"Cập nhật thất bại\";\r\n\t\t\tbreak;\r\n\t\tcase jsb.EventAssetsManager.ERROR_DECOMPRESS:\r\n\t\t\tthis.messageLabel.string = event.getMessage();\r\n\t\t}\r\n\r\n\t\tif (failed) {\r\n            this._am.setEventCallback(null);\r\n            this._updateListener = null;\r\n            this._updating = false;\r\n        }\r\n\r\n        if (needRestart) {\r\n            this._am.setEventCallback(null);\r\n            this._updateListener = null;\r\n            // Prepend the manifest's search path\r\n            var searchPaths = jsb.fileUtils.getSearchPaths();\r\n            var newPaths = this._am.getLocalManifest().getSearchPaths();\r\n            Array.prototype.unshift.apply(searchPaths, newPaths);\r\n            // This value will be retrieved and appended to the default search path during game startup,\r\n            // please refer to samples/js-tests/main.js for detailed usage.\r\n            // !!! Re-add the search paths in main.js is very important, otherwise, new scripts won't take effect.\r\n            cc.sys.localStorage.setItem('HotUpdateSearchPaths', JSON.stringify(searchPaths));\r\n            jsb.fileUtils.setSearchPaths(searchPaths);\r\n\r\n            cc.audioEngine.stopAll();\r\n            cc.game.restart();\r\n        }\r\n\t},\r\n\tonRetryClick: function() {\r\n\t\tthis.retry()\r\n\t},\r\n\tversionCompareHandle: function(t, e) {\r\n\t\tconsole.log(\"JS Custom Version Compare: version A is \" + t + \", version B is \" + e),\r\n\t\tconsole.log(\"JS Custom Version Compare: version A is \" + t + \", version B is \" + e);\r\n\t\tfor (var i = t.split(\".\"), o = e.split(\".\"), n = 0; n < i.length; ++n) {\r\n\t\t\tvar s = parseInt(i[n])\r\n\t\t\t  , a = parseInt(o[n] || 0);\r\n\t\t\tif (s !== a)\r\n\t\t\t\treturn s - a\r\n\t\t}\r\n\t\treturn o.length > i.length ? -1 : 0\r\n\t},\r\n\tupdateProgress: function(progress){\r\n\t\tthis.updateProgressBar.width = progress;\r\n\t\tthis.star.position           = cc.v2(progress, 0);\r\n\t},\r\n});\r\n"]}