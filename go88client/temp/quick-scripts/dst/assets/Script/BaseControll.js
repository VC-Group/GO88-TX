
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/BaseControll.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '19011C1h3JPzKZi+tiWEqax', 'BaseControll');
// Script/BaseControll.js

"use strict";

module.exports = {
  IS_LOGIN: false,
  IS_SOUND: true,
  isConnected: false,
  _socket: null,
  user: {},
  prefab: {},
  setting: {},
  util: {},
  sslPem: {},
  connect: function connect(url) {
    var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/';
    var port = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var ss = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

    if (!this.isConnected) {
      var urlGame = "ws" + (ss ? "" : "") + "://" + url + (!!port ? ":" + port : "") + path;

      if (cc.sys.isBrowser) {
        this._socket = new WebSocket(urlGame);
      } else {
        if (cc.RedT.sslPem) {
          this._socket = new WebSocket(urlGame, [], cc.RedT.sslPem.url);
          this._socket.binaryType = "arraybuffer"; //console.log("Ket noi bang chung chi ssl");
          //console.log("Connect with Pem", cc.RedT.sslPem.url);
        } else {
          this._socket = new WebSocket(urlGame);
        }
      }

      this._socket.onopen = this._onSocketConnect;
      this._socket.onclose = this._onSocketDisconnect;
      this._socket.onmessage = this._onSocketData;
      this._socket.onerror = this._onSocketError;
      this.isConnected = !0; //console.log("Bat dau ket noi may chu");
      //console.log("start connect", urlGame);
    }
  },
  disconnect: function disconnect() {
    //console.log("Hanh dong ngat ket noi");
    //console.log("Action disconnect");
    this.isConnected = !1;

    this._socket.close();
  },
  send: function send(message) {
    try {
      if (this._socket && this._socket.readyState === 1) {
        this._socket.send(this._encodeMessage(message));
      } else {
        console.log("connect send message");
      }
    } catch (err) {
      this.inGame.loading.active = false;
      this.inGame.notice.show({
        title: '',
        text: 'KHÔNG thể kết nối tới máy chủ...'
      });
    }
  },
  _decodeMessage: function _decodeMessage(message) {
    return JSON.parse(message);
  },
  _encodeMessage: function _encodeMessage(message) {
    return JSON.stringify(message);
  },
  _onSocketConnect: function _onSocketConnect() {
    //console.log("Da ket noi may chu");
    //console.log("Websocket connected");
    cc.RedT.isConnected = true;
  },
  _onSocketDisconnect: function _onSocketDisconnect(event) {
    cc.RedT.isConnected = false;

    if (cc.RedT.IS_LOGIN) {
      cc.RedT.inGame.signOut();
    } else {
      cc.RedT.inGame.dialog.onCloseDialog();
    } //console.log("Ngat ket noi may chu");
    //console.log("Socket disconnect", JSON.stringify(event));


    cc.RedT.reconnect();
  },
  _onSocketData: function _onSocketData(message) {
    var data = message.data;
    data = cc.RedT._decodeMessage(data);
    cc.RedT.inGame && cc.RedT.inGame.onData(data);
  },
  _onSocketError: function _onSocketError(message) {//console.log("Loi ket noi May chu");
    //console.log("Socket error", JSON.stringify(message));
  },
  reconnect: function reconnect() {
    this.connect('127.0.0.1', '/client');
  },
  init: function init() {
    cc.view.setResizeCallback(function () {
      if (!!cc.RedT.inGame && !!cc.RedT.inGame.nodeGame) {
        cc.RedT.inGame.nodeGame.x = 0;
        cc.RedT.inGame.nodeGame.y = 0;
      }
    });
    cc.game.on(cc.game.EVENT_HIDE, function () {
      this.timeHide = new Date().getTime();
      this.inGame.newsOn = false;
    }, this);
    cc.game.on(cc.game.EVENT_SHOW, function () {
      this.inGame.newsOn = true;
      setTimeout(function () {
        var check = new Date().getTime();
        check = (check - this.timeHide) / 1000;
        cc.director.getActionManager().update(check);
        cc.director.getAnimationManager().update(check);
      }.bind(this), 100);
    }, this);
    this.initPrototype();
  },
  initPrototype: function initPrototype() {
    String.format || (String.format = function (t) {
      var i = Array.prototype.slice.call(arguments, 1);
      return t.replace(/{(\d+)}/g, function (t, e) {
        return void 0 !== i[e] ? i[e] : t;
      });
    });
  },
  // Function localStorage
  setAutoLogin: function setAutoLogin(bool) {
    localStorage.setItem('AUTO_LOGIN', bool);
  },
  isAutoLogin: function isAutoLogin() {
    var check = localStorage.getItem('AUTO_LOGIN');
    return check == "true";
  },
  setSoundGame: function setSoundGame(bool) {
    localStorage.setItem('SOUND_GAME', bool);
  },
  isSoundGame: function isSoundGame() {
    var check = localStorage.getItem('SOUND_GAME');
    return check == "true";
  },
  setSoundBackground: function setSoundBackground(bool) {
    localStorage.setItem('SOUND_BACKGROUND', bool);
  },
  isSoundBackground: function isSoundBackground() {
    var check = localStorage.getItem('SOUND_BACKGROUND');
    return check == "true";
  },
  userData: function userData(data) {
    if (void 0 !== data.avatar) {
      this.user.avatar = data.avatar;
    }

    if (void 0 !== data.rights) {
      this.user.rights = data.rights;
    }

    if (void 0 !== data.name) {
      this.user.name = data.name;
    }

    if (void 0 !== data.name) {
      this.user.name = data.name;
    }

    if (void 0 !== data.red) {
      this.user.red = data.red;
    }

    if (void 0 !== data.ketSat) {
      this.user.ketSat = data.ketSat;
    }

    if (void 0 !== data.UID) {
      this.user.UID = data.UID;
      localStorage.setItem('TH', data.UID);
    }

    if (void 0 !== data.token) {
      localStorage.setItem('HT', data.token);
    }

    if (void 0 !== data.phone) {
      this.user.phone = data.phone;
      this.user.veryphone = !!data.veryphone;
    }

    if (void 0 !== data.joinedOn) {
      this.user.joinedOn = data.joinedOn;
    }

    if (void 0 !== data.security) {
      this.user.security = data.security;
    } // Level


    if (void 0 !== data.level) {
      this.user.level = data.level;
    }

    if (void 0 !== data.vipHT) {
      this.user.vipHT = data.vipHT;
    }

    if (void 0 !== data.vipNext) {
      this.user.vipNext = data.vipNext;
    }
  },
  CopyToClipboard: function CopyToClipboard(text) {
    if (cc.sys.isBrowser) {
      var el = document.createElement('input');
      el.value = text;
      document.body.appendChild(el);
      el.select();
      el.setSelectionRange(0, 99999);
      document.execCommand('copy');
      el.remove();
    } else {
      jsb.reflection.callStaticMethod('org/cocos2dx/javascript/AppActivity', 'CopyToClipboard', '(Ljava/lang/String;)V', text);
    }
    /**
    	ios:
    	char *p = (char*) content.data();
    	NSString *nsMessage= [[NSString alloc] initWithCString:p encoding:NSUTF8StringEncoding];
    	UIPasteboard *pasteboard = [UIPasteboard generalPasteboard];
    	pasteboard.string = nsMessage;
    */

  }
};

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXC4uXFxhc3NldHNcXFNjcmlwdC8uLlxcLi5cXC4uXFwuLlxcYXNzZXRzXFxTY3JpcHQvYXNzZXRzXFxTY3JpcHRcXEJhc2VDb250cm9sbC5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiSVNfTE9HSU4iLCJJU19TT1VORCIsImlzQ29ubmVjdGVkIiwiX3NvY2tldCIsInVzZXIiLCJwcmVmYWIiLCJzZXR0aW5nIiwidXRpbCIsInNzbFBlbSIsImNvbm5lY3QiLCJ1cmwiLCJwYXRoIiwicG9ydCIsInNzIiwidXJsR2FtZSIsImNjIiwic3lzIiwiaXNCcm93c2VyIiwiV2ViU29ja2V0IiwiUmVkVCIsImJpbmFyeVR5cGUiLCJvbm9wZW4iLCJfb25Tb2NrZXRDb25uZWN0Iiwib25jbG9zZSIsIl9vblNvY2tldERpc2Nvbm5lY3QiLCJvbm1lc3NhZ2UiLCJfb25Tb2NrZXREYXRhIiwib25lcnJvciIsIl9vblNvY2tldEVycm9yIiwiZGlzY29ubmVjdCIsImNsb3NlIiwic2VuZCIsIm1lc3NhZ2UiLCJyZWFkeVN0YXRlIiwiX2VuY29kZU1lc3NhZ2UiLCJjb25zb2xlIiwibG9nIiwiZXJyIiwiaW5HYW1lIiwibG9hZGluZyIsImFjdGl2ZSIsIm5vdGljZSIsInNob3ciLCJ0aXRsZSIsInRleHQiLCJfZGVjb2RlTWVzc2FnZSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsImV2ZW50Iiwic2lnbk91dCIsImRpYWxvZyIsIm9uQ2xvc2VEaWFsb2ciLCJyZWNvbm5lY3QiLCJkYXRhIiwib25EYXRhIiwiaW5pdCIsInZpZXciLCJzZXRSZXNpemVDYWxsYmFjayIsIm5vZGVHYW1lIiwieCIsInkiLCJnYW1lIiwib24iLCJFVkVOVF9ISURFIiwidGltZUhpZGUiLCJEYXRlIiwiZ2V0VGltZSIsIm5ld3NPbiIsIkVWRU5UX1NIT1ciLCJzZXRUaW1lb3V0IiwiY2hlY2siLCJkaXJlY3RvciIsImdldEFjdGlvbk1hbmFnZXIiLCJ1cGRhdGUiLCJnZXRBbmltYXRpb25NYW5hZ2VyIiwiYmluZCIsImluaXRQcm90b3R5cGUiLCJTdHJpbmciLCJmb3JtYXQiLCJ0IiwiaSIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwiYXJndW1lbnRzIiwicmVwbGFjZSIsImUiLCJzZXRBdXRvTG9naW4iLCJib29sIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsImlzQXV0b0xvZ2luIiwiZ2V0SXRlbSIsInNldFNvdW5kR2FtZSIsImlzU291bmRHYW1lIiwic2V0U291bmRCYWNrZ3JvdW5kIiwiaXNTb3VuZEJhY2tncm91bmQiLCJ1c2VyRGF0YSIsImF2YXRhciIsInJpZ2h0cyIsIm5hbWUiLCJyZWQiLCJrZXRTYXQiLCJVSUQiLCJ0b2tlbiIsInBob25lIiwidmVyeXBob25lIiwiam9pbmVkT24iLCJzZWN1cml0eSIsImxldmVsIiwidmlwSFQiLCJ2aXBOZXh0IiwiQ29weVRvQ2xpcGJvYXJkIiwiZWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ2YWx1ZSIsImJvZHkiLCJhcHBlbmRDaGlsZCIsInNlbGVjdCIsInNldFNlbGVjdGlvblJhbmdlIiwiZXhlY0NvbW1hbmQiLCJyZW1vdmUiLCJqc2IiLCJyZWZsZWN0aW9uIiwiY2FsbFN0YXRpY01ldGhvZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQUEsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQ2hCQyxFQUFBQSxRQUFRLEVBQUssS0FERztBQUVoQkMsRUFBQUEsUUFBUSxFQUFLLElBRkc7QUFHaEJDLEVBQUFBLFdBQVcsRUFBRSxLQUhHO0FBSWhCQyxFQUFBQSxPQUFPLEVBQU0sSUFKRztBQUtoQkMsRUFBQUEsSUFBSSxFQUFTLEVBTEc7QUFNaEJDLEVBQUFBLE1BQU0sRUFBTyxFQU5HO0FBT2hCQyxFQUFBQSxPQUFPLEVBQU0sRUFQRztBQVFoQkMsRUFBQUEsSUFBSSxFQUFTLEVBUkc7QUFTaEJDLEVBQUFBLE1BQU0sRUFBSSxFQVRNO0FBVWhCQyxFQUFB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LElBQUksQ0FBQ3lELEtBQXZCO0FBQ0E7O0FBQ0QsUUFBSSxLQUFLLENBQUwsS0FBV3pELElBQUksQ0FBQzBELEtBQXBCLEVBQTBCO0FBQ3pCLFdBQUs1RyxJQUFMLENBQVU0RyxLQUFWLEdBQWtCMUQsSUFBSSxDQUFDMEQsS0FBdkI7QUFDQTs7QUFDRCxRQUFJLEtBQUssQ0FBTCxLQUFXMUQsSUFBSSxDQUFDMkQsT0FBcEIsRUFBNEI7QUFDM0IsV0FBSzdHLElBQUwsQ0FBVTZHLE9BQVYsR0FBb0IzRCxJQUFJLENBQUMyRCxPQUF6QjtBQUNBO0FBQ0QsR0ExTGU7QUEyTGhCQyxFQUFBQSxlQUFlLEVBQUUseUJBQVN0RSxJQUFULEVBQWM7QUFDOUIsUUFBSTdCLEVBQUUsQ0FBQ0MsR0FBSCxDQUFPQyxTQUFYLEVBQXNCO0FBQ3JCLFVBQUlrRyxFQUFFLEdBQUdDLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixPQUF2QixDQUFUO0FBQ0FGLE1BQUFBLEVBQUUsQ0FBQ0csS0FBSCxHQUFXMUUsSUFBWDtBQUNBd0UsTUFBQUEsUUFBUSxDQUFDRyxJQUFULENBQWNDLFdBQWQsQ0FBMEJMLEVBQTFCO0FBQ0FBLE1BQUFBLEVBQUUsQ0FBQ00sTUFBSDtBQUNBTixNQUFBQSxFQUFFLENBQUNPLGlCQUFILENBQXFCLENBQXJCLEVBQXdCLEtBQXhCO0FBQ0FOLE1BQUFBLFFBQVEsQ0FBQ08sV0FBVCxDQUFxQixNQUFyQjtBQUNBUixNQUFBQSxFQUFFLENBQUNTLE1BQUg7QUFDQSxLQVJELE1BUUs7QUFDSkMsTUFBQUEsR0FBRyxDQUFDQyxVQUFKLENBQWVDLGdCQUFmLENBQWdDLHFDQUFoQyxFQUF1RSxpQkFBdkUsRUFBMEYsdUJBQTFGLEVBQW1IbkYsSUFBbkg7QUFDQTtBQUNEOzs7Ozs7OztBQU9BO0FBOU1lLENBQWpCIiwic291cmNlUm9vdCI6Ii4uXFwuLlxcLi5cXC4uXFxhc3NldHNcXFNjcmlwdCIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuXHRJU19MT0dJTjogICAgZmFsc2UsXHJcblx0SVNfU09VTkQ6ICAgIHRydWUsXHJcblx0aXNDb25uZWN0ZWQ6IGZhbHNlLFxyXG5cdF9zb2NrZXQ6ICAgICBudWxsLFxyXG5cdHVzZXI6ICAgICAgICB7fSxcclxuXHRwcmVmYWI6ICAgICAge30sXHJcblx0c2V0dGluZzogICAgIHt9LFxyXG5cdHV0aWw6ICAgICAgICB7fSxcclxuXHRzc2xQZW06IFx0IHt9LFxyXG5cdGNvbm5lY3Q6IGZ1bmN0aW9uKHVybCwgcGF0aCA9ICcvJywgcG9ydCA9IGZhbHNlLCBzcyA9IGZhbHNlKSB7XHJcblx0XHRpZiAoIXRoaXMuaXNDb25uZWN0ZWQpIHtcclxuXHRcdFx0Y29uc3QgdXJsR2FtZSAgICAgICAgICAgPSBcIndzXCIgKyAoc3MgPyBcIlwiIDogXCJcIikgKyBcIjovL1wiICsgdXJsICsgKCEhcG9ydCA/IFwiOlwiICsgcG9ydCA6IFwiXCIpICsgcGF0aDtcclxuXHRcdFx0aWYgKGNjLnN5cy5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsR2FtZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYgKGNjLlJlZFQuc3NsUGVtKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9zb2NrZXQgPSBuZXcgV2ViU29ja2V0KHVybEdhbWUsIFtdLCBjYy5SZWRULnNzbFBlbS51cmwpO1xyXG5cdFx0XHRcdFx0dGhpcy5fc29ja2V0LmJpbmFyeVR5cGUgPSBcImFycmF5YnVmZmVyXCI7XHJcblx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiS2V0IG5vaSBiYW5nIGNodW5nIGNoaSBzc2xcIik7XHJcblx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiQ29ubmVjdCB3aXRoIFBlbVwiLCBjYy5SZWRULnNzbFBlbS51cmwpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0aGlzLl9zb2NrZXQgPSBuZXcgV2ViU29ja2V0KHVybEdhbWUpO1xyXG5cdFx0XHRcdH1cclxuICAgICAgICAgICAgfVxyXG5cdFx0XHR0aGlzLl9zb2NrZXQub25vcGVuICAgID0gdGhpcy5fb25Tb2NrZXRDb25uZWN0O1xyXG5cdFx0XHR0aGlzLl9zb2NrZXQub25jbG9zZSAgID0gdGhpcy5fb25Tb2NrZXREaXNjb25uZWN0O1xyXG5cdFx0XHR0aGlzLl9zb2NrZXQub25tZXNzYWdlID0gdGhpcy5fb25Tb2NrZXREYXRhO1xyXG5cdFx0XHR0aGlzLl9zb2NrZXQub25lcnJvciAgID0gdGhpcy5fb25Tb2NrZXRFcnJvcjtcclxuXHRcdFx0dGhpcy5pc0Nvbm5lY3RlZCAgICAgICA9ICEwO1xyXG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiQmF0IGRhdSBrZXQgbm9pIG1heSBjaHVcIik7XHJcblx0XHRcdC8vY29uc29sZS5sb2coXCJzdGFydCBjb25uZWN0XCIsIHVybEdhbWUpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblx0ZGlzY29ubmVjdDogZnVuY3Rpb24oKSB7XHJcblx0XHQvL2NvbnNvbGUubG9nKFwiSGFuaCBkb25nIG5nYXQga2V0IG5vaVwiKTtcclxuXHRcdC8vY29uc29sZS5sb2coXCJBY3Rpb24gZGlzY29ubmVjdFwiKTtcclxuXHRcdHRoaXMuaXNDb25uZWN0ZWQgPSAhMTtcclxuXHRcdHRoaXMuX3NvY2tldC5jbG9zZSgpO1xyXG5cdH0sXHJcblx0c2VuZDogZnVuY3Rpb24gKG1lc3NhZ2UpIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGlmICh0aGlzLl9zb2NrZXQgJiYgdGhpcy5fc29ja2V0LnJlYWR5U3RhdGUgPT09IDEpIHtcclxuXHRcdFx0XHR0aGlzLl9zb2NrZXQuc2VuZCh0aGlzLl9lbmNvZGVNZXNzYWdlKG1lc3NhZ2UpKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcImNvbm5lY3Qgc2VuZCBtZXNzYWdlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoKGVycikge1xyXG5cdFx0XHR0aGlzLmluR2FtZS5sb2FkaW5nLmFjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmluR2FtZS5ub3RpY2Uuc2hvdyh7dGl0bGU6ICcnLCB0ZXh0OiAnS0jDlE5HIHRo4buDIGvhur90IG7hu5FpIHThu5tpIG3DoXkgY2jhu6cuLi4nfSk7XHJcblx0XHR9XHJcblx0fSxcclxuXHRfZGVjb2RlTWVzc2FnZTogZnVuY3Rpb24obWVzc2FnZSkge1xyXG5cdFx0cmV0dXJuIEpTT04ucGFyc2UobWVzc2FnZSlcclxuXHR9LFxyXG5cdF9lbmNvZGVNZXNzYWdlOiBmdW5jdGlvbihtZXNzYWdlKSB7XHJcblx0XHRyZXR1cm4gSlNPTi5zdHJpbmdpZnkobWVzc2FnZSlcclxuXHR9LFxyXG5cdF9vblNvY2tldENvbm5lY3Q6IGZ1bmN0aW9uICgpIHtcclxuXHRcdC8vY29uc29sZS5sb2coXCJEYSBrZXQgbm9pIG1heSBjaHVcIik7XHJcblx0XHQvL2NvbnNvbGUubG9nKFwiV2Vic29ja2V0IGNvbm5lY3RlZFwiKTtcclxuXHRcdFxyXG5cdFx0Y2MuUmVkVC5pc0Nvbm5lY3RlZCA9IHRydWU7XHJcblx0fSxcclxuXHRfb25Tb2NrZXREaXNjb25uZWN0OiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0Y2MuUmVkVC5pc0Nvbm5lY3RlZCA9IGZhbHNlO1xyXG5cdFx0aWYgKGNjLlJlZFQuSVNfTE9HSU4pIHtcclxuXHRcdFx0Y2MuUmVkVC5pbkdhbWUuc2lnbk91dCgpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdGNjLlJlZFQuaW5HYW1lLmRpYWxvZy5vbkNsb3NlRGlhbG9nKCk7XHJcblx0XHR9XHJcblx0XHQvL2NvbnNvbGUubG9nKFwiTmdhdCBrZXQgbm9pIG1heSBjaHVcIik7XHJcblx0XHQvL2NvbnNvbGUubG9nKFwiU29ja2V0IGRpc2Nvbm5lY3RcIiwgSlNPTi5zdHJpbmdpZnkoZXZlbnQpKTtcclxuXHRcdGNjLlJlZFQucmVjb25uZWN0KCk7XHJcblx0fSxcclxuXHRfb25Tb2NrZXREYXRhOiBmdW5jdGlvbihtZXNzYWdlKSB7XHJcblx0XHR2YXIgZGF0YSA9IG1lc3NhZ2UuZGF0YTtcclxuXHRcdGRhdGEgPSBjYy5SZWRULl9kZWNvZGVNZXNzYWdlKGRhdGEpO1xyXG5cdFx0Y2MuUmVkVC5pbkdhbWUgJiYgY2MuUmVkVC5pbkdhbWUub25EYXRhKGRhdGEpO1xyXG5cdH0sXHJcblx0X29uU29ja2V0RXJyb3I6IGZ1bmN0aW9uIChtZXNzYWdlKSB7XHJcblx0XHQvL2NvbnNvbGUubG9nKFwiTG9pIGtldCBub2kgTWF5IGNodVwiKTtcclxuXHRcdC8vY29uc29sZS5sb2coXCJTb2NrZXQgZXJyb3JcIiwgSlNPTi5zdHJpbmdpZnkobWVzc2FnZSkpO1xyXG5cdH0sXHJcblx0cmVjb25uZWN0OiBmdW5jdGlvbigpe1xyXG5cdFx0dGhpcy5jb25uZWN0KCcxMjcuMC4wLjEnLCcvY2xpZW50Jyk7XHJcblx0fSxcclxuXHRpbml0OiBmdW5jdGlvbigpe1xyXG5cdFx0Y2Mudmlldy5zZXRSZXNpemVDYWxsYmFjayhmdW5jdGlvbigpe1xyXG5cdFx0XHRpZiAoISFjYy5SZWRULmluR2FtZSAmJiAhIWNjLlJlZFQuaW5HYW1lLm5vZGVHYW1lKSB7XHJcblx0XHRcdFx0Y2MuUmVkVC5pbkdhbWUubm9kZUdhbWUueCA9IDA7XHJcblx0XHRcdFx0Y2MuUmVkVC5pbkdhbWUubm9kZUdhbWUueSA9IDA7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0Y2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX0hJREUsIGZ1bmN0aW9uKCl7XHJcblx0XHRcdHRoaXMudGltZUhpZGUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuXHRcdFx0dGhpcy5pbkdhbWUubmV3c09uID0gZmFsc2U7XHJcblx0XHR9LCB0aGlzKTtcclxuXHRcdGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9TSE9XLCBmdW5jdGlvbigpe1xyXG5cdFx0XHR0aGlzLmluR2FtZS5uZXdzT24gPSB0cnVlO1xyXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0bGV0IGNoZWNrID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcblx0XHRcdFx0Y2hlY2sgPSAoY2hlY2stdGhpcy50aW1lSGlkZSkvMTAwMDtcclxuXHRcdFx0XHRjYy5kaXJlY3Rvci5nZXRBY3Rpb25NYW5hZ2VyKCkudXBkYXRlKGNoZWNrKTtcclxuXHRcdFx0XHRjYy5kaXJlY3Rvci5nZXRBbmltYXRpb25NYW5hZ2VyKCkudXBkYXRlKGNoZWNrKTtcclxuXHRcdFx0fS5iaW5kKHRoaXMpLCAxMDApO1xyXG5cdFx0fSwgdGhpcyk7XHJcblx0XHR0aGlzLmluaXRQcm90b3R5cGUoKTtcclxuXHR9LFxyXG5cdGluaXRQcm90b3R5cGU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0U3RyaW5nLmZvcm1hdCB8fCAoU3RyaW5nLmZvcm1hdCA9IGZ1bmN0aW9uKHQpe1xyXG5cdFx0XHR2YXIgaSA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XHJcblx0XHRcdHJldHVybiB0LnJlcGxhY2UoL3soXFxkKyl9L2csIGZ1bmN0aW9uKHQsIGUpIHtcclxuXHRcdFx0XHRyZXR1cm4gdm9pZCAwICE9PSBpW2VdID8gaVtlXSA6IHRcclxuXHRcdFx0fSlcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Ly8gRnVuY3Rpb24gbG9jYWxTdG9yYWdlXHJcblx0c2V0QXV0b0xvZ2luOiBmdW5jdGlvbihib29sKXtcclxuXHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdBVVRPX0xPR0lOJywgYm9vbClcclxuXHR9LFxyXG5cdGlzQXV0b0xvZ2luOiBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIGNoZWNrID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0FVVE9fTE9HSU4nKTtcclxuXHRcdHJldHVybiBjaGVjayA9PSBcInRydWVcIlxyXG5cdH0sXHJcblx0c2V0U291bmRHYW1lOiBmdW5jdGlvbihib29sKXtcclxuXHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdTT1VORF9HQU1FJywgYm9vbClcclxuXHR9LFxyXG5cdGlzU291bmRHYW1lOiBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIGNoZWNrID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1NPVU5EX0dBTUUnKTtcclxuXHRcdHJldHVybiBjaGVjayA9PSBcInRydWVcIlxyXG5cdH0sXHJcblx0c2V0U291bmRCYWNrZ3JvdW5kOiBmdW5jdGlvbihib29sKXtcclxuXHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdTT1VORF9CQUNLR1JPVU5EJywgYm9vbClcclxuXHR9LFxyXG5cdGlzU291bmRCYWNrZ3JvdW5kOiBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIGNoZWNrID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1NPVU5EX0JBQ0tHUk9VTkQnKTtcclxuXHRcdHJldHVybiBjaGVjayA9PSBcInRydWVcIlxyXG5cdH0sXHJcblx0dXNlckRhdGE6IGZ1bmN0aW9uKGRhdGEpe1xyXG5cdFx0aWYgKHZvaWQgMCAhPT0gZGF0YS5hdmF0YXIpe1xyXG5cdFx0XHR0aGlzLnVzZXIuYXZhdGFyID0gZGF0YS5hdmF0YXI7XHJcblx0XHR9XHJcblx0XHRpZiAodm9pZCAwICE9PSBkYXRhLnJpZ2h0cyl7XHJcblx0XHRcdHRoaXMudXNlci5yaWdodHMgPSBkYXRhLnJpZ2h0cztcclxuXHRcdH1cclxuXHRcdGlmICh2b2lkIDAgIT09IGRhdGEubmFtZSl7XHJcblx0XHRcdHRoaXMudXNlci5uYW1lID0gZGF0YS5uYW1lO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHZvaWQgMCAhPT0gZGF0YS5uYW1lKXtcclxuXHRcdFx0dGhpcy51c2VyLm5hbWUgPSBkYXRhLm5hbWU7XHJcblx0XHR9XHJcblx0XHRpZiAodm9pZCAwICE9PSBkYXRhLnJlZCl7XHJcblx0XHRcdHRoaXMudXNlci5yZWQgPSBkYXRhLnJlZDtcclxuXHRcdH1cclxuXHRcdGlmICh2b2lkIDAgIT09IGRhdGEua2V0U2F0KXtcclxuXHRcdFx0dGhpcy51c2VyLmtldFNhdCA9IGRhdGEua2V0U2F0O1xyXG5cdFx0fVxyXG5cdFx0aWYgKHZvaWQgMCAhPT0gZGF0YS5VSUQpe1xyXG5cdFx0XHR0aGlzLnVzZXIuVUlEID0gZGF0YS5VSUQ7XHJcblx0XHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdUSCcsIGRhdGEuVUlEKTtcclxuXHRcdH1cclxuXHRcdGlmICh2b2lkIDAgIT09IGRhdGEudG9rZW4pe1xyXG5cdFx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnSFQnLCBkYXRhLnRva2VuKTtcclxuXHRcdH1cclxuXHRcdGlmICh2b2lkIDAgIT09IGRhdGEucGhvbmUpe1xyXG5cdFx0XHR0aGlzLnVzZXIucGhvbmUgPSBkYXRhLnBob25lO1xyXG5cdFx0XHR0aGlzLnVzZXIudmVyeXBob25lID0gISFkYXRhLnZlcnlwaG9uZTtcclxuXHRcdH1cclxuXHRcdGlmICh2b2lkIDAgIT09IGRhdGEuam9pbmVkT24pe1xyXG5cdFx0XHR0aGlzLnVzZXIuam9pbmVkT24gPSBkYXRhLmpvaW5lZE9uO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHZvaWQgMCAhPT0gZGF0YS5zZWN1cml0eSl7XHJcblx0XHRcdHRoaXMudXNlci5zZWN1cml0eSA9IGRhdGEuc2VjdXJpdHk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gTGV2ZWxcclxuXHRcdGlmICh2b2lkIDAgIT09IGRhdGEubGV2ZWwpe1xyXG5cdFx0XHR0aGlzLnVzZXIubGV2ZWwgPSBkYXRhLmxldmVsO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHZvaWQgMCAhPT0gZGF0YS52aXBIVCl7XHJcblx0XHRcdHRoaXMudXNlci52aXBIVCA9IGRhdGEudmlwSFQ7XHJcblx0XHR9XHJcblx0XHRpZiAodm9pZCAwICE9PSBkYXRhLnZpcE5leHQpe1xyXG5cdFx0XHR0aGlzLnVzZXIudmlwTmV4dCA9IGRhdGEudmlwTmV4dDtcclxuXHRcdH1cclxuXHR9LFxyXG5cdENvcHlUb0NsaXBib2FyZDogZnVuY3Rpb24odGV4dCl7XHJcblx0XHRpZiAoY2Muc3lzLmlzQnJvd3Nlcikge1xyXG5cdFx0XHRsZXQgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG5cdFx0XHRlbC52YWx1ZSA9IHRleHQ7XHJcblx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpO1xyXG5cdFx0XHRlbC5zZWxlY3QoKTtcclxuXHRcdFx0ZWwuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgOTk5OTkpO1xyXG5cdFx0XHRkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpO1xyXG5cdFx0XHRlbC5yZW1vdmUoKTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKCdvcmcvY29jb3MyZHgvamF2YXNjcmlwdC9BcHBBY3Rpdml0eScsICdDb3B5VG9DbGlwYm9hcmQnLCAnKExqYXZhL2xhbmcvU3RyaW5nOylWJywgdGV4dCk7XHJcblx0XHR9XHJcblx0XHQvKipcclxuXHRcdFx0aW9zOlxyXG5cdFx0XHRjaGFyICpwID0gKGNoYXIqKSBjb250ZW50LmRhdGEoKTtcclxuXHRcdFx0TlNTdHJpbmcgKm5zTWVzc2FnZT0gW1tOU1N0cmluZyBhbGxvY10gaW5pdFdpdGhDU3RyaW5nOnAgZW5jb2Rpbmc6TlNVVEY4U3RyaW5nRW5jb2RpbmddO1xyXG5cdFx0XHRVSVBhc3RlYm9hcmQgKnBhc3RlYm9hcmQgPSBbVUlQYXN0ZWJvYXJkIGdlbmVyYWxQYXN0ZWJvYXJkXTtcclxuXHRcdFx0cGFzdGVib2FyZC5zdHJpbmcgPSBuc01lc3NhZ2U7XHJcblx0XHQqL1xyXG5cdH1cclxufVxyXG4iXX0=